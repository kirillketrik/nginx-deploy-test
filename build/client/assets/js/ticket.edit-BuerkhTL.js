import{w as N,W as k,u as w,o as v,K as y,r as C,p as F,j as e,X as M,N as S,U as T,t as d}from"./entry.client-CeFhF4CH.js";import{a as L}from"./vendor-form-CEKaKF0g.js";import{e as E,a as B,B as m,f as I,T as P}from"./button-BZHKdcYg.js";import{F as K,a as p,b as x,c as u,d as h,I as _,e as b,M as q}from"./form-r6jXGqnD.js";import{S as Q}from"./spinner-Bh85W_P9.js";import"./vendor-state-C7_lE9wR.js";import"./vendor-animation-CVFCVbqT.js";import"./vendor-ui-BQCqNqg0.js";import"./badge-df6fIrhB.js";function H(){}const J=N(function(){const{id:n}=k(),l=w(),c=v(),{data:t,isLoading:f}=E(n),{data:a,isLoading:j}=B(),r=y({resolver:L(I),values:t&&a?{price:t.price,transport_ids:t.transports.map(s=>s.id)}:void 0}),g=C.useMemo(()=>a?.transports?new Map(a.transports.map(s=>[s.id,s.name])):new Map,[a?.transports]),i=F({mutationFn:s=>P.update(n,s),onSuccess:()=>{c.invalidateQueries({queryKey:["tickets"]}),c.invalidateQueries({queryKey:["ticket",n]}),d.success("Изменения сохранены"),l("/")},onError:s=>{d.error(s.response?.data?.detail||"Ошибка обновления")}});return f||j?e.jsx("div",{className:"flex h-screen w-full items-center justify-center bg-slate-50",children:e.jsx(Q,{className:"h-8 w-8 text-emerald-500"})}):!a||!t?null:e.jsxs("div",{className:"min-w-full min-h-screen flex flex-col items-center justify-center",children:[e.jsx("div",{className:"space-y-3",children:e.jsx("p",{className:"text-3xl font-black text-center text-black mb-2",children:"Редактирование билета"})}),e.jsx(K,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(s=>i.mutate(s)),className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-[32px] p-6 shadow-sm border border-slate-100 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("span",{className:"text-black text-sm font-black tracking-tight",children:t.organization.city}),e.jsx("span",{className:"bg-[#2D4F44] text-[#78D3B0] text-[11px] font-bold px-3 py-1 rounded-lg uppercase tracking-wider",children:t.type})]}),e.jsx(p,{control:r.control,name:"price",render:({field:s})=>e.jsxs(x,{children:[e.jsx(u,{className:"text-slate-500 font-bold text-xs uppercase tracking-wider",children:"Стоимость (BYN)"}),e.jsx(h,{children:e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-black"}),e.jsx(_,{type:"number",step:"0.01",className:"pl-10 h-12 bg-slate-50 border-none rounded-2xl focus-visible:ring-emerald-500/30 text-lg text-black font-bold",placeholder:"0.00",...s,onFocus:o=>o.target.select(),onChange:o=>s.onChange(o.target.valueAsNumber||0)})]})}),e.jsx(b,{})]})}),e.jsx(p,{control:r.control,name:"transport_ids",render:({field:s})=>e.jsxs(x,{children:[e.jsx(u,{className:"text-slate-500 font-bold text-xs uppercase tracking-wider",children:"Транспортные средства"}),e.jsx(h,{children:e.jsx(q,{field:s,transports:a.transports,transportMap:g})}),e.jsx(b,{})]})})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(m,{type:"submit",disabled:i.isPending,className:"w-full h-14 rounded-2xl text-base font-bold bg-emerald-600 hover:bg-emerald-700 shadow-lg shadow-emerald-200 transition-all active:scale-[0.98]",children:[i.isPending?e.jsx(S,{className:"animate-spin mr-2 h-5 w-5"}):e.jsx(T,{className:"mr-2 h-5 w-5"}),"Сохранить изменения"]}),e.jsx(m,{type:"button",onClick:()=>l(-1),className:"w-full h-12 rounded-2xl",children:"Отмена"})]})]})})]})});export{H as clientLoader,J as default};
