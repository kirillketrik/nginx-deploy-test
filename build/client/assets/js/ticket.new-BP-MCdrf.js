import{j as e,R as S,q as _,I as F,C,V as I,v as T,x as M,y as V,z as B,A as E,D as L,E as P,F as D,G as R,H as U,w as q,u as K,o as A,K as H,p as Q,r as Y,N as f,U as G,t as O}from"./entry.client-CeFhF4CH.js";import{a as J}from"./vendor-form-CEKaKF0g.js";import{c as i,a as W,b as X,B as j,d as Z,T as $}from"./button-BZHKdcYg.js";import{F as ee,a as c,b as d,c as m,d as x,e as u,I as te,M as se}from"./form-r6jXGqnD.js";import"./vendor-state-C7_lE9wR.js";import"./vendor-animation-CVFCVbqT.js";import"./vendor-ui-BQCqNqg0.js";import"./badge-df6fIrhB.js";function v({...s}){return e.jsx(S,{"data-slot":"select",...s})}function b({...s}){return e.jsx(I,{"data-slot":"select-value",...s})}function w({className:s,size:r="default",children:n,...l}){return e.jsxs(_,{"data-slot":"select-trigger","data-size":r,className:i("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...l,children:[n,e.jsx(F,{asChild:!0,children:e.jsx(C,{className:"size-4 opacity-50"})})]})}function N({className:s,children:r,position:n="item-aligned",align:l="center",...p}){return e.jsx(T,{children:e.jsxs(M,{"data-slot":"select-content",className:i("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,align:l,...p,children:[e.jsx(ae,{}),e.jsx(V,{className:i("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:r}),e.jsx(re,{})]})})}function y({className:s,children:r,...n}){return e.jsxs(B,{"data-slot":"select-item",className:i("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",s),...n,children:[e.jsx("span",{"data-slot":"select-item-indicator",className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(E,{children:e.jsx(L,{className:"size-4"})})}),e.jsx(P,{children:r})]})}function ae({className:s,...r}){return e.jsx(D,{"data-slot":"select-scroll-up-button",className:i("flex cursor-default items-center justify-center py-1",s),...r,children:e.jsx(R,{className:"size-4"})})}function re({className:s,...r}){return e.jsx(U,{"data-slot":"select-scroll-down-button",className:i("flex cursor-default items-center justify-center py-1",s),...r,children:e.jsx(C,{className:"size-4"})})}function ue(){}const pe=q(function(){const r=K(),n=A(),{data:l,isLoading:p,isSuccess:k}=W(),o=H({resolver:J(Z),mode:"onChange",defaultValues:{organization:"",type:X.MONTHLY,price:0,transport_ids:[]}}),h=Q({mutationFn:t=>$.create(t),onSuccess:async()=>{await n.invalidateQueries({queryKey:["tickets"]}),O.success("Билет успешно создан"),r("/")}}),g=l?.transports||[],z=Y.useMemo(()=>new Map(g.map(t=>[t.id,t.name])),[g]);return p&&!k?e.jsx("div",{className:"flex h-screen w-full items-center justify-center bg-slate-50",children:e.jsx(f,{className:"h-8 w-8 animate-spin text-emerald-500"})}):e.jsxs("div",{className:"min-w-full min-h-screen flex flex-col items-center justify-center",children:[e.jsx("div",{className:"space-y-3",children:e.jsx("p",{className:"text-3xl font-black text-center text-black mb-2",children:"Создание билета"})}),e.jsx(ee,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(t=>h.mutate(t)),className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-[32px] p-6 shadow-sm border border-slate-100 space-y-5",children:[e.jsx(c,{control:o.control,name:"organization",render:({field:t})=>e.jsxs(d,{children:[e.jsx(m,{className:"text-slate-500 font-bold text-xs uppercase tracking-wider ml-1",children:"Организация"}),e.jsxs(v,{onValueChange:t.onChange,value:t.value,children:[e.jsx(x,{children:e.jsx(w,{className:"h-12 bg-slate-50 border-none rounded-2xl focus:ring-emerald-500/30 text-slate-900 w-full overflow-hidden",children:e.jsx("div",{className:"flex-1 text-left truncate",children:e.jsx(b,{placeholder:"Выберите организацию"})})})}),e.jsx(N,{className:"rounded-2xl border-slate-100 shadow-xl max-w-[calc(100vw-2rem)] md:w-[var(--radix-select-trigger-width)]",children:l?.organizations.map(a=>e.jsx(y,{value:a.id,textValue:a.name,children:e.jsxs("div",{className:"flex flex-col min-w-0 py-1",children:[e.jsx("span",{className:"font-bold text-slate-700 truncate",children:a.name}),e.jsx("span",{className:"text-[10px] text-slate-400 uppercase tracking-tight mt-1",children:a.city})]})},a.id))})]}),e.jsx(u,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(c,{control:o.control,name:"type",render:({field:t})=>e.jsxs(d,{children:[e.jsx(m,{className:"text-slate-500 font-bold text-xs uppercase tracking-wider ml-1",children:"Период"}),e.jsxs(v,{onValueChange:t.onChange,value:t.value,children:[e.jsx(x,{children:e.jsx(w,{className:"h-12 bg-slate-50 border-none rounded-2xl text-slate-900",children:e.jsx(b,{placeholder:"Тип"})})}),e.jsx(N,{className:"rounded-xl",children:l?.ticket_types.map(a=>e.jsx(y,{value:a,children:a},a))})]}),e.jsx(u,{})]})}),e.jsx(c,{control:o.control,name:"price",render:({field:t})=>e.jsxs(d,{children:[e.jsx(m,{className:"text-slate-500 font-bold text-xs uppercase tracking-wider ml-1",children:"Цена (BYN)"}),e.jsx(x,{children:e.jsx(te,{type:"number",step:"0.01",className:"h-12 bg-slate-50 border-none rounded-2xl font-bold text-slate-900",...t,onFocus:a=>a.target.select(),onChange:a=>t.onChange(a.target.valueAsNumber||0)})}),e.jsx(u,{})]})})]}),e.jsx(c,{control:o.control,name:"transport_ids",render:({field:t})=>e.jsxs(d,{children:[e.jsx(m,{className:"text-slate-500 font-bold text-xs uppercase tracking-wider ml-1",children:"Транспорт"}),e.jsx(x,{children:e.jsx(se,{field:t,transports:l?.transports||[],transportMap:z})}),e.jsx(u,{})]})})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(j,{type:"submit",disabled:!o.formState.isValid||h.isPending,className:"w-full h-14 rounded-2xl text-base font-bold bg-emerald-600 hover:bg-emerald-700 shadow-lg shadow-emerald-200 transition-all active:scale-[0.98]",children:[h.isPending?e.jsx(f,{className:"animate-spin mr-2 h-5 w-5"}):e.jsx(G,{className:"mr-2 h-5 w-5"}),"Создать"]}),e.jsx(j,{type:"button",onClick:()=>r(-1),className:"w-full h-12 rounded-2xl",children:"Отмена"})]})]})})]})});export{ue as clientLoader,pe as default};
