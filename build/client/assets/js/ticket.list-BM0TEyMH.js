import{j as e,B as g,c as v,d as N,u as b,e as y,f as k,h as p,m as c,P as w,i as D,k as C,l as T,n as _,w as E,o as B,r as M,p as S,t as z}from"./entry.client-CeFhF4CH.js";import{c as u,B as j,u as F,M as I,T as L}from"./button-BZHKdcYg.js";import{S as P}from"./spinner-Bh85W_P9.js";import{B as Q}from"./badge-df6fIrhB.js";import{D as W,a as q,b as K,c as R,d as A,e as V,f as $}from"./dialog-DP08yuvj.js";import"./vendor-state-C7_lE9wR.js";import"./vendor-animation-CVFCVbqT.js";import"./vendor-ui-BQCqNqg0.js";import"./vendor-form-CEKaKF0g.js";const H=({name:s,className:t})=>s==="bus"?e.jsx(g,{className:t}):s==="tram"?e.jsx(v,{className:t}):s==="train"?e.jsx(N,{className:t}):e.jsx(g,{className:t});function O({transport:s,className:t}){return e.jsxs(Q,{className:u("flex items-center gap-1.5 p-1.5 rounded-lg","glass-effect shadow-none","transition-transform hover:scale-105 active:scale-95",t),variant:"outline",children:[e.jsx(H,{name:s.icon,className:"h-3.5 w-3.5 text-primary/80"}),e.jsx("span",{className:"text-[10px] font-semibold leading-none uppercase tracking-wider text-slate-700",children:s.name})]})}function Y({ticket:s,onEdit:t,onDelete:i}){const n=b(),l=y(0),r=k(l,{stiffness:400,damping:30}),o={WebkitMaskImage:`radial-gradient(circle at 0 74%, transparent 12px, black 13px), 
                          radial-gradient(circle at 100% 74%, transparent 12px, black 13px)`,WebkitMaskComposite:"source-in",maskComposite:"intersect"},h=p(r,[0,80],[0,1]),d=p(r,[0,-80],[0,1]),a=p(r,[-100,0,100],[1.2,.8,1.2]),x=(m,f)=>{f.offset.x>120&&t?.(s),f.offset.x<-120&&i?.(s)};return e.jsxs("div",{className:"relative mb-2 p-4",children:[e.jsxs("div",{className:"absolute inset-4 rounded-[32px] overflow-hidden flex justify-between items-center z-0",children:[e.jsx(c.div,{style:{opacity:h},className:"absolute inset-0 bg-emerald-500 flex items-center justify-start pl-10",children:e.jsx(c.div,{style:{scale:a},children:e.jsx(w,{className:"text-white",size:28})})}),e.jsx(c.div,{style:{opacity:d},className:"absolute inset-0 bg-rose-500 flex items-center justify-end pr-10",children:e.jsx(c.div,{style:{scale:a},children:e.jsx(D,{className:"text-white",size:28})})})]}),e.jsx(c.div,{drag:"x",dragConstraints:{left:0,right:0},dragElastic:.5,onDragEnd:x,style:{x:r},whileTap:{scale:.96},className:"relative z-10 cursor-pointer touch-pan-y",children:e.jsx("div",{className:"filter drop-shadow-[0_20px_25px_rgba(0,0,0,0.15)] group",children:e.jsxs("div",{style:o,onClick:()=>n(`/tickets/${s.id}`),className:u("bg-white rounded-[32px] text-slate-800 transition-colors duration-300","hover:bg-slate-50 active:bg-slate-100"),children:[e.jsxs("div",{className:"p-6 pb-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("span",{className:"bg-[#2D4F44] text-[#78D3B0] text-[11px] font-bold px-3 py-1 rounded-lg uppercase tracking-wider",children:s.lifecycle.active_period}),e.jsxs("span",{className:"text-gray-700 text-sm font-bold tracking-tight",children:[s.price," BYN"]})]}),e.jsx("div",{className:"flex justify-between items-center mb-8 px-1",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-3xl font-black tracking-tight",children:s.organization.city}),e.jsx("span",{className:"text-slate-400 font-medium",children:s.organization.name})]})}),e.jsx("div",{className:"flex flex-wrap items-center gap-3 mb-6",children:s.transports.map(m=>e.jsx(O,{transport:m},m.id))})]}),e.jsxs("div",{className:"p-6 py-5 flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-400 font-bold text-[10px] uppercase tracking-[0.2em] font-mono",children:"Номер проездного"}),e.jsx("span",{className:"text-slate-900 font-black text-xl tracking-wider",children:s.number})]})]})})})]})}function G(){const s={WebkitMaskImage:`radial-gradient(circle at 0 74%, transparent 12px, black 13px), 
                          radial-gradient(circle at 100% 74%, transparent 12px, black 13px)`,WebkitMaskComposite:"source-in",maskComposite:"intersect"};return e.jsx("div",{className:"relative mb-2 p-4",children:e.jsx(C,{to:"/tickets/new",prefetch:"intent",className:"group relative block w-full text-left transition-transform active:scale-[0.98] outline-none",children:e.jsx("div",{className:"filter drop-shadow-[0_10px_15px_rgba(0,0,0,0.08)] group-hover:drop-shadow-[0_20px_25px_rgba(0,0,0,0.12)] transition-all duration-300",children:e.jsxs("div",{style:s,className:u("bg-white rounded-[32px] border-2 border-dashed border-slate-200","flex flex-col items-center justify-center py-10 transition-colors duration-300","group-hover:border-emerald-500/30 group-hover:bg-slate-50/50"),children:[e.jsx("div",{className:"p-4 rounded-2xl bg-slate-50 group-hover:bg-emerald-50 transition-colors duration-300",children:e.jsx(T,{className:"h-8 w-8 text-slate-400 group-hover:text-emerald-500 transition-colors duration-300"})}),e.jsxs("div",{className:"mt-4 flex flex-col items-center gap-1",children:[e.jsx("span",{className:"text-slate-900 font-black text-lg tracking-tight",children:"Создать"}),e.jsx("span",{className:"text-slate-400 font-medium text-xs uppercase tracking-widest font-mono",children:"Новый билет"})]})]})})})})}function J({open:s,onOpenChange:t,ticket:i,onConfirm:n}){return i?e.jsx(W,{open:s,onOpenChange:t,children:e.jsxs(q,{className:"sm:max-w-lg",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-red-100",children:e.jsx(_,{className:"h-6 w-6 text-red-600"})}),e.jsxs(K,{children:[e.jsx(R,{className:"text-black",children:"Удаление билета"}),e.jsxs(A,{children:["Это действие нельзя будет отменить. Билет № ",i.number," будет безвозвратно удален."]})]})]}),e.jsxs(V,{children:[e.jsx($,{asChild:!0,children:e.jsx(j,{variant:"outline",className:"text-black",children:"Отмена"})}),e.jsx(j,{variant:"destructive",onClick:()=>n(),children:"Удалить"})]})]})}):null}function le(){}const ce=E(function(){const t=b(),i=B(),[n,l]=M.useState(null),r=F(),o=S({mutationFn:a=>L.delete(a),onSuccess:async(a,x)=>{await Promise.all([i.invalidateQueries({queryKey:["tickets"]}),i.invalidateQueries({queryKey:["ticket",x]})]),z.success("Билет удален")}});if(r.isLoading)return e.jsx("div",{className:"flex h-screen w-full items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(P,{className:"h-8 w-8 text-primary"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Загрузка данных..."})]})});const d=r.data||[];return new I().create(),e.jsxs("div",{className:"flex flex-col items-center min-h-screen w-full w-min-sm py-10",children:[e.jsx("div",{className:"min-w-sm max-w-md flex flex-col gap-6",children:e.jsxs("main",{className:"flex flex-col gap-4",children:[d.map(a=>e.jsx(Y,{ticket:a,onDelete:()=>l(a),onEdit:()=>t(`/tickets/${a.id}/edit`)},a.id)),e.jsx(G,{})]})}),e.jsx(J,{open:!!n,ticket:n,onOpenChange:a=>!a&&l(null),onConfirm:()=>{o.mutate(n.id),l(null)}})]})});export{le as clientLoader,ce as default};
